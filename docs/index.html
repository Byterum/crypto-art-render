<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>crypto-art-render</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.js" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">crypto-art-render</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1>crypto-art-render</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#crypto-art-render" id="crypto-art-render" style="color: inherit; text-decoration: none;">
					<h1>crypto-art-render</h1>
				</a>
				<p>Magic render of crypto art.</p>
				<a href="#install" id="install" style="color: inherit; text-decoration: none;">
					<h2>Install</h2>
				</a>
				<pre><code>npm <span class="hljs-keyword">install</span> crypto-art-render -S</code></pre><p>or</p>
				<pre><code>yarn <span class="hljs-keyword">install</span> crypto-art-render</code></pre>
				<a href="#update" id="update" style="color: inherit; text-decoration: none;">
					<h2>Update</h2>
				</a>
				<ul>
					<li>Allow artwork with only 1 master layer.</li>
					<li><code>anchor</code> always be type of <code>string</code>, not controlled by tokens any more.</li>
				</ul>
				<a href="#master-config" id="master-config" style="color: inherit; text-decoration: none;">
					<h2>Master Config</h2>
				</a>
				<p>Master config defines <strong>the rule of rendering</strong> for the artwork.</p>
				<p>A typical config data structure is shown below:</p>
				<ul>
					<li><strong>name</strong> - Artwork name.</li>
					<li><strong>description</strong> - Artwork description.</li>
					<li><strong>image</strong> - URI of artwork master.</li>
					<li><strong>attributes</strong> - List of basic meta info.<ul>
							<li>trait_type - Attribute key name Like <code>Artist</code> or <code>Layer Count</code>.</li>
							<li>value - Attribute value string.</li>
						</ul>
					</li>
					<li><strong>layout</strong> - Layout of layers.</li>
				</ul>
				<a href="#intproperty" id="intproperty" style="color: inherit; text-decoration: none;">
					<h3>IntProperty</h3>
				</a>
				<p>This type tells the property can be controlled by <strong>layer token</strong> or just a pure integer.</p>
				<p>In typescript, we define:</p>
				<pre><code class="language-javascript">type IntProperty = {
    <span class="hljs-string">"token-id"</span>: number,
    <span class="hljs-string">"lever-id"</span>: number
  } or number;</code></pre>
				<ul>
					<li>token-id - Control layer token id on chain.</li>
					<li>lever-id - Lever index of values from a layer token.</li>
				</ul>
				<a href="#layeroption" id="layeroption" style="color: inherit; text-decoration: none;">
					<h3>LayerOption</h3>
				</a>
				<p>A layer option defines an option of a layer that token holder can choose.</p>
				<ul>
					<li><p><strong>uri</strong> - Layer resource URI, usually IPFS Cid of image.</p>
					</li>
					<li><p><strong>label</strong> - Layer label.</p>
					</li>
					<li><p><strong>anchor</strong> - optional. Anchor point id.</p>
					</li>
					<li><p><strong>fixed-position</strong> - optional. Fix position of layer at the artwork.</p>
						<ul>
							<li>x (IntProperty)</li>
							<li>y (IntProperty)</li>
						</ul>
					</li>
					<li><p><strong>relative-position</strong> - optional. Relative position of layer <strong>with the coordinate of</strong> the anchor layer.</p>
						<ul>
							<li>x (IntProperty)</li>
							<li>y (IntProperty)</li>
						</ul>
					</li>
					<li><p><strong>fixed-rotation</strong> (IntProperty) - optional. Fix rotation degree.</p>
					</li>
					<li><p><strong>orbit-rotation</strong> (IntPropery) - optional. Orbit rotation degree around the anchor provided by the layer.</p>
					</li>
					<li><p><strong>mirror</strong> (IntPropery) - optional. Mirror transition. Value result will only be <code>0</code> or <code>1</code>.</p>
					</li>
					<li><p><strong>visible</strong> (IntPropery) - optional. Is layer visible. Value result will only be <code>0</code> or <code>1</code>.</p>
					</li>
					<li><p><strong>finalCenterX</strong> (number) - Not pre-defined. Final center coordinate x of layer. This property will be filled during rendering process.</p>
					</li>
					<li><p><strong>finalCenterY</strong> (number) - Not pre-defined. Final center coordinate y of layer. This property will be filled during rendering process.</p>
					</li>
					<li><p><strong>active</strong> (boolean) - Not pre-defined. Tell the layer can be used as anchor point or not.</p>
					</li>
					<li><p><strong>color</strong> - Color scheme of layer</p>
						<ul>
							<li>red (IntProperty)</li>
							<li>green (IntProperty)</li>
							<li>blue (IntProperty)</li>
							<li>alpha (IntProperty)</li>
							<li>hue (IntProperty)</li>
						</ul>
					</li>
				</ul>
				<a href="#layer" id="layer" style="color: inherit; text-decoration: none;">
					<h3>Layer</h3>
				</a>
				<p><strong>Inherit from LayerOption</strong>, with more fields like:</p>
				<ul>
					<li><strong>id</strong> - Required. Layer id</li>
					<li><strong>states</strong> - Optional. Multiple state options of layer.<ul>
							<li>options <code>Array&lt;LayerOption&gt;</code> - list of layer option</li>
							<li>token-id - Token that control the value of option index.</li>
							<li>lever-id - Lever index of values</li>
						</ul>
					</li>
				</ul>
				<p>Please see a typical <a href="master_example.json">master config example</a>.</p>
				<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
					<h2>Usage</h2>
				</a>
				<a href="#generator" id="generator" style="color: inherit; text-decoration: none;">
					<h3>Generator</h3>
				</a>
				<p>Module <code>generator</code> is used to generate artwokr config, define and fill necessary fields more easily.</p>
				<p>Check out the <a href="https://mobiusgame.github.io/crypto-art-render/classes/_generator_.generator.html">API</a>.</p>
				<p><strong>Initialize empty config</strong></p>
				<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { Generator } <span class="hljs-keyword">from</span> <span class="hljs-string">"crypto-art-render"</span>;

<span class="hljs-keyword">const</span> generator = <span class="hljs-keyword">new</span> Generator();
<span class="hljs-comment">// Initialize master config with basic info</span>
generator.intialize(
  <span class="hljs-string">"name"</span>,
  <span class="hljs-string">"desc"</span>,
  <span class="hljs-string">"QmX71QqNunRjE3Sdj78vDGrDyeT3dEMp9xrrQPSx5JCBTQ"</span>
);

<span class="hljs-comment">// Set attributes</span>
generator.setAttributes([
  {
    [KEY_TRAIT_TYPE]: <span class="hljs-string">"Artist"</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-string">"LowesYang"</span>
  },
  {
    [KEY_TRAIT_TYPE]: <span class="hljs-string">"Artist"</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-string">"YYH"</span>
  },
  {
    [KEY_TRAIT_TYPE]: <span class="hljs-string">"Layer Count"</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-string">"4"</span>
  }
]);

<span class="hljs-comment">// Set fields in master config</span>
generator.setLayout(<span class="hljs-string">"layer id"</span>, <span class="hljs-number">1</span>);
generator.addStatesLayer(<span class="hljs-string">"layer id"</span>, states);
generator.addPureLayer(<span class="hljs-string">"layer id"</span>, layerbody);

<span class="hljs-built_in">console</span>.log(generator.masterConfig); <span class="hljs-comment">// see `test/config_example/example1.json`</span>

<span class="hljs-keyword">const</span> eosApi = <span class="hljs-keyword">new</span> EosAPI();
<span class="hljs-comment">// Initialize artwork on chain</span>
<span class="hljs-comment">// Add config file init by `generator` to IPFS node.</span>
<span class="hljs-keyword">const</span> configCid = <span class="hljs-string">"QmQRYre2kUKd3VW13CeY6zowwyK8RwXqbJxkjzpVS6cyrc"</span>;
generator.mintwork(eosApi, <span class="hljs-string">"contract"</span>, <span class="hljs-string">"artist"</span>, <span class="hljs-string">"issuer"</span>);

<span class="hljs-comment">// say master id is 1, layer token relative id is 1</span>
<span class="hljs-comment">// the real layer token id on chaini is 1 + 1 = 2</span>
<span class="hljs-comment">// Setup token on chain</span>
generator.setuptoken(eosApi, <span class="hljs-string">"contract"</span>, <span class="hljs-string">"eosio"</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, [<span class="hljs-number">0</span>], [<span class="hljs-number">256</span>], [<span class="hljs-number">144</span>]);

<span class="hljs-comment">// Update token on chain</span>
generator.updatetoken(eosApi, <span class="hljs-string">"contract"</span>, <span class="hljs-string">"eosio"</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, [<span class="hljs-number">0</span>], [<span class="hljs-number">145</span>]);</code></pre>
				<a href="#render" id="render" style="color: inherit; text-decoration: none;">
					<h3>Render</h3>
				</a>
				<p>Module <code>Render</code> is used to render image from master config.</p>
				<p>Check out the <a href="https://mobiusgame.github.io/crypto-art-render/classes/_render_.render.html">API</a>.</p>
				<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { Render, IpfsLoader } <span class="hljs-keyword">from</span> <span class="hljs-string">"crypto-art-render"</span>;

<span class="hljs-comment">// Initialize render with ipfs loader, interacting with local IPFS node</span>
<span class="hljs-keyword">const</span> render = <span class="hljs-keyword">new</span> Render(
  <span class="hljs-keyword">new</span> IpfsLoader({ <span class="hljs-attr">endpoint</span>: <span class="hljs-string">"http://127.0.0.1:8080"</span> })
);

<span class="hljs-comment">// load master config</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">await</span> render.loadMasterConfig(<span class="hljs-string">"contract"</span>, masterTokenId));

<span class="hljs-comment">// render image</span>
<span class="hljs-keyword">const</span> masterTokenId = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> masterImage = <span class="hljs-keyword">await</span> render.renderMaster(<span class="hljs-string">"contract"</span>, masterTokenId);
<span class="hljs-keyword">const</span> compositeImage = <span class="hljs-keyword">await</span> render.renderComposite(<span class="hljs-string">"contract"</span>, masterTokenId);

<span class="hljs-comment">// Interact with result folloing the API of [Jimp](https://github.com/oliver-moran/jimp/tree/master/packages/jimp)</span>

<span class="hljs-keyword">await</span> masterImage.writeAsync(<span class="hljs-string">"master.png"</span>);
<span class="hljs-keyword">await</span> compositeImage.writeAsync(<span class="hljs-string">"composite.png"</span>);

<span class="hljs-comment">// Get current state of a artwork. It will return the hash of current</span>
<span class="hljs-comment">// values from layer tokens.</span>
render.currentState(masterTokenId);</code></pre>
				<a href="#test" id="test" style="color: inherit; text-decoration: none;">
					<h2>Test</h2>
				</a>
				<ol>
					<li>Start a local IPFS node with http endpoint listening on <code>8080</code>.</li>
					<li>Add all files in <code>test/config_example</code> to local IPFS network.</li>
					<li>Start a local EOSIO network with http endpoint listening on <code>8888</code>;</li>
					<li>Run <code>npm run test</code></li>
				</ol>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_blockchain_datatype_.html">&quot;blockchain/datatype&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_blockchain_eos_.html">&quot;blockchain/eos&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_blockchain_eth_.html">&quot;blockchain/eth&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_blockchain_index_.html">&quot;blockchain/index&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_generator_.html">&quot;generator&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_index_.html">&quot;index&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_loader_index_.html">&quot;loader/index&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_loader_interface_.html">&quot;loader/interface&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_loader_ipfs_loader_.html">&quot;loader/ipfs_<wbr>loader&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_master_config_.html">&quot;master_<wbr>config&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_render_.html">&quot;render&quot;</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>